{% extends "main/menu_base_flip.html" %}

{% load currency %}
{% load thumbnail %}

{% block header %}

{% endblock header %}

{% block side_navigation %}
  {% if pro %}
    <li><div class="chev"><a href="{% url party_add %}">Create Party</a></div></li>
  {% endif %}

  <li><div class="chev"><a href="{% url party_taster_invite %}">Invite Attendee</a></div></li>

  {% if taster %}
    <li><div class="chev"><a href="{% url host_vinely_party %}">Host a Vinely Taste Party</a></div></li>
  {% endif %}
{% endblock side_navigation %}

{% block main_content %}

  <div class="row">
    <div class="span8">
      <h1 class="headline">Your Vinely Taste Parties</h1>
    </div>
  </div>
  <section id="sub-heading">
    <div class="row">
      <div class="span8">
        {% if socializer %}
          <a href="{% url edit_subscription %}">Contact your Vinely Pro</a> to host a new party.  Once your party has been scheduled, it will appear below.
        {% elif pro %}
          Parties you are managing
        {% elif taster %}
          Parties you are attending
        {% endif %}
      </div>
    </div>
  </section>
  <section id="socializer-info">

    <div class="user-info">
      <div class="user-pic">
        {% if user.get_profile.image %}
          {% thumbnail user.get_profile.image "120x120" as im %}
            <img src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}">
          {% endthumbnail %}
        {% else %}
          <img width="120" src="http://i3.squidoocdn.com/resize/squidoo_images/250/draft_lens12465611module112776691photo_1280702420jessica-simpson-drunk.jpg">
        {% endif %}
      </div>
      <div class="user-contact">
        <div class="user-name">
          {% if user.first_name %}
            {{ user.first_name }} {{ user.last_name }}
          {% else %}
            Vinely Host 
          {% endif %}
        </div>
        <div class="user-phone">
          <i class="icon-user"></i> {% if user.get_profile.phone %}{{ user.get_profile.phone }}{% else %}No Phone Number Yet{% endif %}
        </div>
        <div class="user-email">
          <a href="mailto:{{ user.email }}">{{ user.email }}</a>
        </div>
      </div>
    </div>
  </section>

  <section id="upcoming-parties">
  <div class="page-header">
    Upcoming Parties
  </div>
  <table class="table table-striped">
    <thead>
      <th>Date/Time</th>
      <th>Host</th>
      <th>Title</th>
      <th>Contact Phone</th>
      <th>Location</th>
      <th>Tasters</th>
    </thead>
    <tbody>
    {% for party in parties %}
      {# create a table of party and party information #}
      <tr>
        <td>{{ party.event_date|date:"M d, Y" }}</td>
        <td><a href="mailto:{{ party.socializer.email }}">{% if party.socializer.first_name %}{{ party.socializer.first_name }} {{ party.socializer.last_name }}{% else %}{{ party.socializer.email }}{% endif %}</a></td>
        <td><a href="{% url party_details party.id %}">{{ party.title }}</a></td>
        <td>{{ party.phone }}</td>
        <td>{{ party.address }}</td>
        <td>{% if party.invitees %}{{ party.invitees }}{% else %}<a href="{% url party_taster_invite party.id %}">Invite Guests</a>{% endif %}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
  </section>

  <section id="past-parties">
  <div class="page-header">
    Past Parties
  </div>
  <table class="table table-striped">
    <thead>
      <th>Date/Time</th>
      <th>Host</th>
      <th>Title</th>
      <th>Contact Phone</th>
      <th>Location</th>
      <th>Tasters</th>
      <th>My Credit</th>
    </thead>
    <tbody>
    {% for party in past_parties %}
      {# create a table of party and party information #}
      <tr>
        <td>{{ party.event_date|date:"M d, Y" }}</td>
        <td><a href="mailto:{{ party.socializer.email }}">{% if party.socializer.first_name %}{{ party.socializer.first_name }} {{ party.socializer.last_name }}{% else %}{{ party.socializer.email }}{% endif %}</a></td>
        <td><a href="{% url party_details party.id %}">{{ party.title }}</a></td>
        <td>{{ party.phone }}</td>
        <td>{{ party.address }}</td>
        <td>{{ party.invitees }}</td>
        <td>{{ party.credit|currency }}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
  </section>

{% endblock main_content %}

{% block additional_scripts %}
  <script type="text/javascript">
    $(".side-nav li").hover(
      function () {
        $(this).children(".chev").addClass("active");
        $(this).find("a").addClass("hovered");
      },
      function () {
        $(this).children(".chev").removeClass("active");
        $(this).find("a").removeClass("hovered");
      }
    );
  </script>
{% endblock additional_scripts %}
