{% extends "winedora/base_html5.html" %}

{% load currency %}
{% load thumbnail %}

{% block header %}
  <h1>Checkout: Place Order</h1>
{% endblock header %}

{% block content %}

<div class="container" data-spy="scroll" data-offset="50" data-target=".subnav">

  <div class="row">
    <div class="span12">
      <table class="table">
        <thead>
          <tr>
            <th>Item</th>
            <th>Quantity</th>
            <th>Total</th>
            <th>Remove</th>
          </tr>
        </thead>
        <tbody>
          {% for item in items %}
          <tr>
            <td>
              <div class="cart-item">
                <div class="cart-item-image">
                {% thumbnail item.product.image "100x100" format="PNG" as im %}
                  <img src="{{ im.url }}"/>
                {% endthumbnail %}
                </div>
                <div class="cart-item-name">
                  {{ item.product.name }} (Vinely product ID: {{ item.product.id }})
                </div>
              </div>
            </td>
            <td>{{ item.quantity_str }}</td>
            <td>{{ item.subtotal|currency }}</td>
            <td><a href="{% url cart_remove_item cart.id item.id %}?next={% url place_order %}"><i class="icon-trash"></i></a></td> 
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <section id="shipping-billing">
  <div class="row">
    {# Need to check for permissions whether this is a party specialist #}
    <div class="span3">
      <p><h3>Shipping Information</h3></p>
      <address>
        <p>{{ user.first_name }} {{ user.last_name }}</p>
        <p>{{ shipping_address.street1 }}</p>
        {% if shipping_address.street2 %}
        <p>{{ shipping_address.street2 }}</p>
        {% endif %}
        <p>{{ shipping_address.city }}, {{ shipping_address.state }} {{ shipping_address.zipcode }}</p>
        <p><a href="{% url edit_shipping_address %}">Edit</a></p>
      </address>
    </div>
    <div class="span3">
      <p><h3>Billing Information</h3></p>
      <p></p>
      <p>Credit card ending in {{ credit_card.last_four }}</p>
      <p>Exp Date: {{ credit_card.exp_date }}</p>
      <p><a href="{% url edit_credit_card %}">Edit</a></p>
    </div>
    <div class="span3">
      &nbsp;
    </div>
    <div class="span3">
      <p>&nbsp;</p>
      <p>Subtotal: {{ cart.subtotal|currency }}</p>
      <p>Shipping: {{ cart.shipping|currency }}</p>
      <p>Tax: {{ cart.tax|currency }}</p>
      <p><b>Total: {{ cart.total|currency }}</b></p>
    </div>
  </div>
  </section>

  <div class="row">
    {# Need to check for permissions whether this is a party specialist #}
    <div class="span12">
      <div class="form-actions">
        <div class="pull-right">
          <form action="{% url place_order %}" method="POST">
            {% csrf_token %}
            <input class="btn btn-primary" type="submit" value="Place Order">
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

